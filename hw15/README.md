# Оконные функции

### Решение

[Процедура для генерации данных]()

[Запросы]()

### Учет граничных условий

1. нарастающий итог по месяцам -  
Возможно, в какие-то месяцы не было продаж. Чтобы они не выпали из отчета, сгенерирован календарь  
за последние 24 месяца и сделан LEFT JOIN, чтобы все месяцы присутствовали в выводе.

2. 7-дневное скользящее среднее
Возможно, что данные за какие-то дни отсутствуют. Это разорвет окно, и среднее будет рассчитано не за календарные 7 дней, а за 7 последних записей.
Чтобы этого избежать, сооздан календарь всех дней за последний месяц и сделан LEFT JOIN, чтобы в выборке присутствовали все дни.